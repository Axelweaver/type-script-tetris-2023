var ce=Object.defineProperty;var he=(s,o,t)=>o in s?ce(s,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[o]=t;var v=(s,o,t)=>(he(s,typeof o!="symbol"?o+"":o,t),t);(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const f of a)if(f.type==="childList")for(const c of f.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const f={};return a.integrity&&(f.integrity=a.integrity),a.referrerPolicy&&(f.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?f.credentials="include":a.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function i(a){if(a.ep)return;a.ep=!0;const f=t(a);fetch(a.href,f)}})();function H(s,o){s!=null&&s.clearRect(o.positionX,o.positionY,o.width,o.height)}function me(s,o,t,i,a,f,c){if(s==null)return;const A=Math.round(f*.1);s.strokeStyle=o,s.beginPath(),s.lineWidth=1,s.moveTo(i+A,a+c-A),s.lineTo(i+A,a+A),s.lineTo(i+f-A,a+A),s.stroke(),s.beginPath(),s.strokeStyle=t,s.moveTo(i+A,a+c-A),s.lineTo(i-A+f,a+c-A),s.lineTo(i-A+f,a+A),s.stroke()}function re(s,o,t,i,a,f){s!=null&&(s.strokeStyle=o,s.strokeRect(t,i,a,f))}function K(s,o,t,i,a,f){s!=null&&(s.fillStyle=o,s.fillRect(t,i,a,f))}function pe(s,o,t,i,a=1){s!=null&&(o=o/a,t=t/a,s.scale(a,a),s.beginPath(),s.lineWidth=1,s.fillStyle=i,s.strokeStyle=i,s.moveTo(o,t),s.moveTo(o+47.0849493,t-142108547e-22),s.lineTo(o+298.668,t+251.583611),s.lineTo(o+304.101001,t+257.015597),s.lineTo(o+304.101,t+257.016),s.lineTo(o+353.573532,t+306.488791),s.bezierCurveTo(o+353.573732,t+306.488458,o+353.573933,t+306.488124,o+353.574133,t+306.48779),s.lineTo(o+384.435257,t+337.348961),s.lineTo(o+384.434,t+337.349),s.lineTo(o+409.751616,t+362.666662),s.lineTo(o+379.581717,t+392.836561),s.lineTo(o+191.749,t+205.003),s.lineTo(o+191.749973,t+369.105851),s.lineTo(o+81.0208,t+283.647505),s.lineTo(o+710542736e-23,t+283.647505),s.lineTo(o+710542736e-23,t+112.980838),s.lineTo(o+80.8957867,t+112.980838),s.lineTo(o+91.433,t+104.688),s.lineTo(o+16.9150553,t+30.169894),s.lineTo(o+47.0849493,t-142108547e-22),s.closePath(),s.moveTo(o+361.298133,t+28.0146513),s.bezierCurveTo(o+429.037729,t+103.653701,o+443.797162,t+209.394226,o+405.578884,t+298.151284),s.lineTo(o+372.628394,t+265.201173),s.bezierCurveTo(o+396.498256,t+194.197542,o+381.626623,t+113.228555,o+328.013013,t+54.642278),s.lineTo(o+361.298133,t+28.0146513),s.closePath(),s.moveTo(o+276.912853,t+95.5237713),s.bezierCurveTo(o+305.539387,t+127.448193,o+318.4688,t+168.293162,o+315.701304,t+208.275874),s.lineTo(o+266.464558,t+159.040303),s.bezierCurveTo(o+261.641821,t+146.125608,o+254.316511,t+133.919279,o+244.488548,t+123.156461),s.lineTo(o+243.588693,t+122.182545),s.lineTo(o+276.912853,t+95.5237713),s.closePath(),s.moveTo(o+191.749973,t+25.7516113),s.lineTo(o+191.749,t+84.3256113),s.lineTo(o+158.969,t+51.5456113),s.lineTo(o+191.749973,t+25.7516113),s.closePath(),s.fill("evenodd"),s.stroke(),s.restore(),s.setTransform(1,0,0,1,0,0))}function Ae(s,o,t,i,a=1){s!=null&&(o=o/a,t=t/a,s.scale(a,a),s.beginPath(),s.lineWidth=1,s.fillStyle=i,s.strokeStyle=i,s.moveTo(o,t),s.translate(42.666667,85.333333),s.moveTo(o+361.299413,t+341.610667),s.lineTo(o+328.014293,t+314.98176),s.bezierCurveTo(o+402.206933,t+233.906133,o+402.206933,t+109.96608,o+328.013013,t+28.8906667),s.lineTo(o+361.298133,t+2.26304),s.bezierCurveTo(o+447.910187,t+98.97536,o+447.908907,t+244.898347,o+361.299413,t+341.610667),s.closePath(),s.moveTo(o+276.912853,t+69.77216),s.lineTo(o+243.588693,t+96.4309333),s.bezierCurveTo(o+283.38432,t+138.998613,o+283.38304,t+204.87488,o+243.589973,t+247.44256),s.lineTo(o+276.914133,t+274.101333),s.bezierCurveTo(o+329.118507,t+215.880107,o+329.118507,t+127.992107,o+276.912853,t+69.77216),s.closePath(),s.moveTo(o+191.749973,t+142108547e-22),s.lineTo(o+80.8957867,t+87.2292267),s.lineTo(o+710542736e-23,t+87.2292267),s.lineTo(o+710542736e-23,t+257.895893),s.lineTo(o+81.0208,t+257.895893),s.lineTo(o+191.749973,t+343.35424),s.lineTo(o+191.749973,t+142108547e-22),s.lineTo(o+191.749973,t+142108547e-22),s.closePath(),s.fill("evenodd"),s.stroke(),s.restore(),s.setTransform(1,0,0,1,0,0))}function C(s,o,t,i){s!=null&&(s.fillStyle=t,s.font=o.font,s.textAlign=o.align,s.textBaseline="middle",s.fillText(i,o.positionX,o.positionY))}function ne(s,o){return Math.floor(Math.random()*(o-s+1))+s}function qe(s){const o=s.length-1;return s.map((i,a)=>i.map((f,c)=>s[o-c][a]))}const ve="#gameCanvas",M=10,D=20,F=2,oe=-2,ae=3,ge=94,S="#F0FFF0",we="#B22222",Y="#DCDCDC",ie=[[[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0]],[[1,1,1],[0,0,1],[0,0,0]],[[1,1,1],[1,0,0],[0,0,0]],[[1,1],[1,1]],[[0,1,1],[1,1,0],[0,0,0]],[[1,1,1],[0,1,0],[0,0,0]],[[1,1,0],[0,1,1],[0,0,0]]],le=[["#87CEFA","#48D1CC","#AFEEEE"],["#B22222","#8B0000","#CD5C5C"],["#228B22","#006400","#98FB98"],["#0000CD","#00008B","#4169E1"],["#98FB98","#66CDAA","#7FFF00"],["#FFD700","#DAA520","#FFFACD"],["#FF69B4","#CD5C5C","#FFB6C1"]];var G=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},k={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(s){(function(){var o=function(){this.init()};o.prototype={init:function(){var e=this||t;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var r=this||t;if(e=parseFloat(e),r.ctx||b(),typeof e<"u"&&e>=0&&e<=1){if(r._volume=e,r._muted)return r;r.usingWebAudio&&r.masterGain.gain.setValueAtTime(e,t.ctx.currentTime);for(var n=0;n<r._howls.length;n++)if(!r._howls[n]._webAudio)for(var l=r._howls[n]._getSoundIds(),d=0;d<l.length;d++){var _=r._howls[n]._soundById(l[d]);_&&_._node&&(_._node.volume=_._volume*e)}return r}return r._volume},mute:function(e){var r=this||t;r.ctx||b(),r._muted=e,r.usingWebAudio&&r.masterGain.gain.setValueAtTime(e?0:r._volume,t.ctx.currentTime);for(var n=0;n<r._howls.length;n++)if(!r._howls[n]._webAudio)for(var l=r._howls[n]._getSoundIds(),d=0;d<l.length;d++){var _=r._howls[n]._soundById(l[d]);_&&_._node&&(_._node.muted=e?!0:_._muted)}return r},stop:function(){for(var e=this||t,r=0;r<e._howls.length;r++)e._howls[r].stop();return e},unload:function(){for(var e=this||t,r=e._howls.length-1;r>=0;r--)e._howls[r].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,b()),e},codecs:function(e){return(this||t)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||t;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var r=new Audio;typeof r.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch{e.noAudio=!0}else e.noAudio=!0;try{var r=new Audio;r.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||t,r=null;try{r=typeof Audio<"u"?new Audio:null}catch{return e}if(!r||typeof r.canPlayType!="function")return e;var n=r.canPlayType("audio/mpeg;").replace(/^no$/,""),l=e._navigator?e._navigator.userAgent:"",d=l.match(/OPR\/([0-6].)/g),_=d&&parseInt(d[0].split("/")[1],10)<33,u=l.indexOf("Safari")!==-1&&l.indexOf("Chrome")===-1,m=l.match(/Version\/(.*?) /),q=u&&m&&parseInt(m[1],10)<15;return e._codecs={mp3:!!(!_&&(n||r.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!n,opus:!!r.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(r.canPlayType('audio/wav; codecs="1"')||r.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!r.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!r.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(r.canPlayType("audio/x-m4a;")||r.canPlayType("audio/m4a;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(r.canPlayType("audio/x-m4b;")||r.canPlayType("audio/m4b;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(r.canPlayType("audio/x-mp4;")||r.canPlayType("audio/mp4;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!q&&r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!q&&r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!r.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(r.canPlayType("audio/x-flac;")||r.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||t;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var r=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var l=new Audio;l._unlocked=!0,e._releaseHtml5Audio(l)}catch{e.noAudio=!0;break}for(var d=0;d<e._howls.length;d++)if(!e._howls[d]._webAudio)for(var _=e._howls[d]._getSoundIds(),u=0;u<_.length;u++){var m=e._howls[d]._soundById(_[u]);m&&m._node&&!m._node._unlocked&&(m._node._unlocked=!0,m._node.load())}e._autoResume();var q=e.ctx.createBufferSource();q.buffer=e._scratchBuffer,q.connect(e.ctx.destination),typeof q.start>"u"?q.noteOn(0):q.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),q.onended=function(){q.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",r,!0),document.removeEventListener("touchend",r,!0),document.removeEventListener("click",r,!0),document.removeEventListener("keydown",r,!0);for(var y=0;y<e._howls.length;y++)e._howls[y]._emit("unlock")}};return document.addEventListener("touchstart",r,!0),document.addEventListener("touchend",r,!0),document.addEventListener("click",r,!0),document.addEventListener("keydown",r,!0),e}},_obtainHtml5Audio:function(){var e=this||t;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var r=new Audio().play();return r&&typeof Promise<"u"&&(r instanceof Promise||typeof r.then=="function")&&r.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var r=this||t;return e._unlocked&&r._html5AudioPool.push(e),r},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!t.usingWebAudio)){for(var r=0;r<e._howls.length;r++)if(e._howls[r]._webAudio){for(var n=0;n<e._howls[r]._sounds.length;n++)if(!e._howls[r]._sounds[n]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var l=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(l,l)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!t.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var r=0;r<e._howls.length;r++)e._howls[r]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var t=new o,i=function(e){var r=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}r.init(e)};i.prototype={init:function(e){var r=this;return t.ctx||b(),r._autoplay=e.autoplay||!1,r._format=typeof e.format!="string"?e.format:[e.format],r._html5=e.html5||!1,r._muted=e.mute||!1,r._loop=e.loop||!1,r._pool=e.pool||5,r._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,r._rate=e.rate||1,r._sprite=e.sprite||{},r._src=typeof e.src!="string"?e.src:[e.src],r._volume=e.volume!==void 0?e.volume:1,r._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},r._duration=0,r._state="unloaded",r._sounds=[],r._endTimers={},r._queue=[],r._playLock=!1,r._onend=e.onend?[{fn:e.onend}]:[],r._onfade=e.onfade?[{fn:e.onfade}]:[],r._onload=e.onload?[{fn:e.onload}]:[],r._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],r._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],r._onpause=e.onpause?[{fn:e.onpause}]:[],r._onplay=e.onplay?[{fn:e.onplay}]:[],r._onstop=e.onstop?[{fn:e.onstop}]:[],r._onmute=e.onmute?[{fn:e.onmute}]:[],r._onvolume=e.onvolume?[{fn:e.onvolume}]:[],r._onrate=e.onrate?[{fn:e.onrate}]:[],r._onseek=e.onseek?[{fn:e.onseek}]:[],r._onunlock=e.onunlock?[{fn:e.onunlock}]:[],r._onresume=[],r._webAudio=t.usingWebAudio&&!r._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(r),r._autoplay&&r._queue.push({event:"play",action:function(){r.play()}}),r._preload&&r._preload!=="none"&&r.load(),r},load:function(){var e=this,r=null;if(t.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var l,d;if(e._format&&e._format[n])l=e._format[n];else{if(d=e._src[n],typeof d!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}l=/^data:audio\/([^;,]+);/i.exec(d),l||(l=/\.([^.]+)$/.exec(d.split("?",1)[0])),l&&(l=l[1].toLowerCase())}if(l||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),l&&t.codecs(l)){r=e._src[n];break}}if(!r){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=r,e._state="loading",window.location.protocol==="https:"&&r.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new a(e),e._webAudio&&c(e),e},play:function(e,r){var n=this,l=null;if(typeof e=="number")l=e,e=null;else{if(typeof e=="string"&&n._state==="loaded"&&!n._sprite[e])return null;if(typeof e>"u"&&(e="__default",!n._playLock)){for(var d=0,_=0;_<n._sounds.length;_++)n._sounds[_]._paused&&!n._sounds[_]._ended&&(d++,l=n._sounds[_]._id);d===1?e=null:l=null}}var u=l?n._soundById(l):n._inactiveSound();if(!u)return null;if(l&&!e&&(e=u._sprite||"__default"),n._state!=="loaded"){u._sprite=e,u._ended=!1;var m=u._id;return n._queue.push({event:"play",action:function(){n.play(m)}}),m}if(l&&!u._paused)return r||n._loadQueue("play"),u._id;n._webAudio&&t._autoResume();var q=Math.max(0,u._seek>0?u._seek:n._sprite[e][0]/1e3),y=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-q),x=y*1e3/Math.abs(u._rate),O=n._sprite[e][0]/1e3,z=(n._sprite[e][0]+n._sprite[e][1])/1e3;u._sprite=e,u._ended=!1;var J=function(){u._paused=!1,u._seek=q,u._start=O,u._stop=z,u._loop=!!(u._loop||n._sprite[e][2])};if(q>=z){n._ended(u);return}var g=u._node;if(n._webAudio){var X=function(){n._playLock=!1,J(),n._refreshBuffer(u);var B=u._muted||n._muted?0:u._volume;g.gain.setValueAtTime(B,t.ctx.currentTime),u._playStart=t.ctx.currentTime,typeof g.bufferSource.start>"u"?u._loop?g.bufferSource.noteGrainOn(0,q,86400):g.bufferSource.noteGrainOn(0,q,y):u._loop?g.bufferSource.start(0,q,86400):g.bufferSource.start(0,q,y),x!==1/0&&(n._endTimers[u._id]=setTimeout(n._ended.bind(n,u),x)),r||setTimeout(function(){n._emit("play",u._id),n._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?X():(n._playLock=!0,n.once("resume",X),n._clearTimer(u._id))}else{var ee=function(){g.currentTime=q,g.muted=u._muted||n._muted||t._muted||g.muted,g.volume=u._volume*t.volume(),g.playbackRate=u._rate;try{var B=g.play();if(B&&typeof Promise<"u"&&(B instanceof Promise||typeof B.then=="function")?(n._playLock=!0,J(),B.then(function(){n._playLock=!1,g._unlocked=!0,r?n._loadQueue():n._emit("play",u._id)}).catch(function(){n._playLock=!1,n._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),u._ended=!0,u._paused=!0})):r||(n._playLock=!1,J(),n._emit("play",u._id)),g.playbackRate=u._rate,g.paused){n._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||u._loop?n._endTimers[u._id]=setTimeout(n._ended.bind(n,u),x):(n._endTimers[u._id]=function(){n._ended(u),g.removeEventListener("ended",n._endTimers[u._id],!1)},g.addEventListener("ended",n._endTimers[u._id],!1))}catch(fe){n._emit("playerror",u._id,fe)}};g.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(g.src=n._src,g.load());var _e=window&&window.ejecta||!g.readyState&&t._navigator.isCocoonJS;if(g.readyState>=3||_e)ee();else{n._playLock=!0,n._state="loading";var te=function(){n._state="loaded",ee(),g.removeEventListener(t._canPlayEvent,te,!1)};g.addEventListener(t._canPlayEvent,te,!1),n._clearTimer(u._id)}}return u._id},pause:function(e){var r=this;if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"pause",action:function(){r.pause(e)}}),r;for(var n=r._getSoundIds(e),l=0;l<n.length;l++){r._clearTimer(n[l]);var d=r._soundById(n[l]);if(d&&!d._paused&&(d._seek=r.seek(n[l]),d._rateSeek=0,d._paused=!0,r._stopFade(n[l]),d._node))if(r._webAudio){if(!d._node.bufferSource)continue;typeof d._node.bufferSource.stop>"u"?d._node.bufferSource.noteOff(0):d._node.bufferSource.stop(0),r._cleanBuffer(d._node)}else(!isNaN(d._node.duration)||d._node.duration===1/0)&&d._node.pause();arguments[1]||r._emit("pause",d?d._id:null)}return r},stop:function(e,r){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var l=n._getSoundIds(e),d=0;d<l.length;d++){n._clearTimer(l[d]);var _=n._soundById(l[d]);_&&(_._seek=_._start||0,_._rateSeek=0,_._paused=!0,_._ended=!0,n._stopFade(l[d]),_._node&&(n._webAudio?_._node.bufferSource&&(typeof _._node.bufferSource.stop>"u"?_._node.bufferSource.noteOff(0):_._node.bufferSource.stop(0),n._cleanBuffer(_._node)):(!isNaN(_._node.duration)||_._node.duration===1/0)&&(_._node.currentTime=_._start||0,_._node.pause(),_._node.duration===1/0&&n._clearSound(_._node))),r||n._emit("stop",_._id))}return n},mute:function(e,r){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,r)}}),n;if(typeof r>"u")if(typeof e=="boolean")n._muted=e;else return n._muted;for(var l=n._getSoundIds(r),d=0;d<l.length;d++){var _=n._soundById(l[d]);_&&(_._muted=e,_._interval&&n._stopFade(_._id),n._webAudio&&_._node?_._node.gain.setValueAtTime(e?0:_._volume,t.ctx.currentTime):_._node&&(_._node.muted=t._muted?!0:e),n._emit("mute",_._id))}return n},volume:function(){var e=this,r=arguments,n,l;if(r.length===0)return e._volume;if(r.length===1||r.length===2&&typeof r[1]>"u"){var d=e._getSoundIds(),_=d.indexOf(r[0]);_>=0?l=parseInt(r[0],10):n=parseFloat(r[0])}else r.length>=2&&(n=parseFloat(r[0]),l=parseInt(r[1],10));var u;if(typeof n<"u"&&n>=0&&n<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,r)}}),e;typeof l>"u"&&(e._volume=n),l=e._getSoundIds(l);for(var m=0;m<l.length;m++)u=e._soundById(l[m]),u&&(u._volume=n,r[2]||e._stopFade(l[m]),e._webAudio&&u._node&&!u._muted?u._node.gain.setValueAtTime(n,t.ctx.currentTime):u._node&&!u._muted&&(u._node.volume=n*t.volume()),e._emit("volume",u._id))}else return u=l?e._soundById(l):e._sounds[0],u?u._volume:0;return e},fade:function(e,r,n,l){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"fade",action:function(){d.fade(e,r,n,l)}}),d;e=Math.min(Math.max(0,parseFloat(e)),1),r=Math.min(Math.max(0,parseFloat(r)),1),n=parseFloat(n),d.volume(e,l);for(var _=d._getSoundIds(l),u=0;u<_.length;u++){var m=d._soundById(_[u]);if(m){if(l||d._stopFade(_[u]),d._webAudio&&!m._muted){var q=t.ctx.currentTime,y=q+n/1e3;m._volume=e,m._node.gain.setValueAtTime(e,q),m._node.gain.linearRampToValueAtTime(r,y)}d._startFadeInterval(m,e,r,n,_[u],typeof l>"u")}}return d},_startFadeInterval:function(e,r,n,l,d,_){var u=this,m=r,q=n-r,y=Math.abs(q/.01),x=Math.max(4,y>0?l/y:l),O=Date.now();e._fadeTo=n,e._interval=setInterval(function(){var z=(Date.now()-O)/l;O=Date.now(),m+=q*z,m=Math.round(m*100)/100,q<0?m=Math.max(n,m):m=Math.min(n,m),u._webAudio?e._volume=m:u.volume(m,e._id,!0),_&&(u._volume=m),(n<r&&m<=n||n>r&&m>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,u.volume(n,e._id),u._emit("fade",e._id))},x)},_stopFade:function(e){var r=this,n=r._soundById(e);return n&&n._interval&&(r._webAudio&&n._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(n._interval),n._interval=null,r.volume(n._fadeTo,e),n._fadeTo=null,r._emit("fade",e)),r},loop:function(){var e=this,r=arguments,n,l,d;if(r.length===0)return e._loop;if(r.length===1)if(typeof r[0]=="boolean")n=r[0],e._loop=n;else return d=e._soundById(parseInt(r[0],10)),d?d._loop:!1;else r.length===2&&(n=r[0],l=parseInt(r[1],10));for(var _=e._getSoundIds(l),u=0;u<_.length;u++)d=e._soundById(_[u]),d&&(d._loop=n,e._webAudio&&d._node&&d._node.bufferSource&&(d._node.bufferSource.loop=n,n&&(d._node.bufferSource.loopStart=d._start||0,d._node.bufferSource.loopEnd=d._stop,e.playing(_[u])&&(e.pause(_[u],!0),e.play(_[u],!0)))));return e},rate:function(){var e=this,r=arguments,n,l;if(r.length===0)l=e._sounds[0]._id;else if(r.length===1){var d=e._getSoundIds(),_=d.indexOf(r[0]);_>=0?l=parseInt(r[0],10):n=parseFloat(r[0])}else r.length===2&&(n=parseFloat(r[0]),l=parseInt(r[1],10));var u;if(typeof n=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,r)}}),e;typeof l>"u"&&(e._rate=n),l=e._getSoundIds(l);for(var m=0;m<l.length;m++)if(u=e._soundById(l[m]),u){e.playing(l[m])&&(u._rateSeek=e.seek(l[m]),u._playStart=e._webAudio?t.ctx.currentTime:u._playStart),u._rate=n,e._webAudio&&u._node&&u._node.bufferSource?u._node.bufferSource.playbackRate.setValueAtTime(n,t.ctx.currentTime):u._node&&(u._node.playbackRate=n);var q=e.seek(l[m]),y=(e._sprite[u._sprite][0]+e._sprite[u._sprite][1])/1e3-q,x=y*1e3/Math.abs(u._rate);(e._endTimers[l[m]]||!u._paused)&&(e._clearTimer(l[m]),e._endTimers[l[m]]=setTimeout(e._ended.bind(e,u),x)),e._emit("rate",u._id)}}else return u=e._soundById(l),u?u._rate:e._rate;return e},seek:function(){var e=this,r=arguments,n,l;if(r.length===0)e._sounds.length&&(l=e._sounds[0]._id);else if(r.length===1){var d=e._getSoundIds(),_=d.indexOf(r[0]);_>=0?l=parseInt(r[0],10):e._sounds.length&&(l=e._sounds[0]._id,n=parseFloat(r[0]))}else r.length===2&&(n=parseFloat(r[0]),l=parseInt(r[1],10));if(typeof l>"u")return 0;if(typeof n=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,r)}}),e;var u=e._soundById(l);if(u)if(typeof n=="number"&&n>=0){var m=e.playing(l);m&&e.pause(l,!0),u._seek=n,u._ended=!1,e._clearTimer(l),!e._webAudio&&u._node&&!isNaN(u._node.duration)&&(u._node.currentTime=n);var q=function(){m&&e.play(l,!0),e._emit("seek",l)};if(m&&!e._webAudio){var y=function(){e._playLock?setTimeout(y,0):q()};setTimeout(y,0)}else q()}else if(e._webAudio){var x=e.playing(l)?t.ctx.currentTime-u._playStart:0,O=u._rateSeek?u._rateSeek-u._seek:0;return u._seek+(O+x*Math.abs(u._rate))}else return u._node.currentTime;return e},playing:function(e){var r=this;if(typeof e=="number"){var n=r._soundById(e);return n?!n._paused:!1}for(var l=0;l<r._sounds.length;l++)if(!r._sounds[l]._paused)return!0;return!1},duration:function(e){var r=this,n=r._duration,l=r._soundById(e);return l&&(n=r._sprite[l._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,r=e._sounds,n=0;n<r.length;n++)r[n]._paused||e.stop(r[n]._id),e._webAudio||(e._clearSound(r[n]._node),r[n]._node.removeEventListener("error",r[n]._errorFn,!1),r[n]._node.removeEventListener(t._canPlayEvent,r[n]._loadFn,!1),r[n]._node.removeEventListener("ended",r[n]._endFn,!1),t._releaseHtml5Audio(r[n]._node)),delete r[n]._node,e._clearTimer(r[n]._id);var l=t._howls.indexOf(e);l>=0&&t._howls.splice(l,1);var d=!0;for(n=0;n<t._howls.length;n++)if(t._howls[n]._src===e._src||e._src.indexOf(t._howls[n]._src)>=0){d=!1;break}return f&&d&&delete f[e._src],t.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,r,n,l){var d=this,_=d["_on"+e];return typeof r=="function"&&_.push(l?{id:n,fn:r,once:l}:{id:n,fn:r}),d},off:function(e,r,n){var l=this,d=l["_on"+e],_=0;if(typeof r=="number"&&(n=r,r=null),r||n)for(_=0;_<d.length;_++){var u=n===d[_].id;if(r===d[_].fn&&u||!r&&u){d.splice(_,1);break}}else if(e)l["_on"+e]=[];else{var m=Object.keys(l);for(_=0;_<m.length;_++)m[_].indexOf("_on")===0&&Array.isArray(l[m[_]])&&(l[m[_]]=[])}return l},once:function(e,r,n){var l=this;return l.on(e,r,n,1),l},_emit:function(e,r,n){for(var l=this,d=l["_on"+e],_=d.length-1;_>=0;_--)(!d[_].id||d[_].id===r||e==="load")&&(setTimeout((function(u){u.call(this,r,n)}).bind(l,d[_].fn),0),d[_].once&&l.off(e,d[_].fn,d[_].id));return l._loadQueue(e),l},_loadQueue:function(e){var r=this;if(r._queue.length>0){var n=r._queue[0];n.event===e&&(r._queue.shift(),r._loadQueue()),e||n.action()}return r},_ended:function(e){var r=this,n=e._sprite;if(!r._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(r._ended.bind(r,e),100),r;var l=!!(e._loop||r._sprite[n][2]);if(r._emit("end",e._id),!r._webAudio&&l&&r.stop(e._id,!0).play(e._id),r._webAudio&&l){r._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=t.ctx.currentTime;var d=(e._stop-e._start)*1e3/Math.abs(e._rate);r._endTimers[e._id]=setTimeout(r._ended.bind(r,e),d)}return r._webAudio&&!l&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,r._clearTimer(e._id),r._cleanBuffer(e._node),t._autoSuspend()),!r._webAudio&&!l&&r.stop(e._id,!0),r},_clearTimer:function(e){var r=this;if(r._endTimers[e]){if(typeof r._endTimers[e]!="function")clearTimeout(r._endTimers[e]);else{var n=r._soundById(e);n&&n._node&&n._node.removeEventListener("ended",r._endTimers[e],!1)}delete r._endTimers[e]}return r},_soundById:function(e){for(var r=this,n=0;n<r._sounds.length;n++)if(e===r._sounds[n]._id)return r._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var r=0;r<e._sounds.length;r++)if(e._sounds[r]._ended)return e._sounds[r].reset();return new a(e)},_drain:function(){var e=this,r=e._pool,n=0,l=0;if(!(e._sounds.length<r)){for(l=0;l<e._sounds.length;l++)e._sounds[l]._ended&&n++;for(l=e._sounds.length-1;l>=0;l--){if(n<=r)return;e._sounds[l]._ended&&(e._webAudio&&e._sounds[l]._node&&e._sounds[l]._node.disconnect(0),e._sounds.splice(l,1),n--)}}},_getSoundIds:function(e){var r=this;if(typeof e>"u"){for(var n=[],l=0;l<r._sounds.length;l++)n.push(r._sounds[l]._id);return n}else return[e]},_refreshBuffer:function(e){var r=this;return e._node.bufferSource=t.ctx.createBufferSource(),e._node.bufferSource.buffer=f[r._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,t.ctx.currentTime),r},_cleanBuffer:function(e){var r=this,n=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(t._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),n))try{e.bufferSource.buffer=t._scratchBuffer}catch{}return e.bufferSource=null,r},_clearSound:function(e){var r=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);r||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(e){this._parent=e,this.init()};a.prototype={init:function(){var e=this,r=e._parent;return e._muted=r._muted,e._loop=r._loop,e._volume=r._volume,e._rate=r._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,r._sounds.push(e),e.create(),e},create:function(){var e=this,r=e._parent,n=t._muted||e._muted||e._parent._muted?0:e._volume;return r._webAudio?(e._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),e._node.gain.setValueAtTime(n,t.ctx.currentTime),e._node.paused=!0,e._node.connect(t.masterGain)):t.noAudio||(e._node=t._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(t._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=r._src,e._node.preload=r._preload===!0?"auto":r._preload,e._node.volume=n*t.volume(),e._node.load()),e},reset:function(){var e=this,r=e._parent;return e._muted=r._muted,e._loop=r._loop,e._volume=r._volume,e._rate=r._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,r=e._parent;r._duration=Math.ceil(e._node.duration*10)/10,Object.keys(r._sprite).length===0&&(r._sprite={__default:[0,r._duration*1e3]}),r._state!=="loaded"&&(r._state="loaded",r._emit("load"),r._loadQueue()),e._node.removeEventListener(t._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,r=e._parent;r._duration===1/0&&(r._duration=Math.ceil(e._node.duration*10)/10,r._sprite.__default[1]===1/0&&(r._sprite.__default[1]=r._duration*1e3),r._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var f={},c=function(e){var r=e._src;if(f[r]){e._duration=f[r].duration,h(e);return}if(/^data:[^;]+;base64,/.test(r)){for(var n=atob(r.split(",")[1]),l=new Uint8Array(n.length),d=0;d<n.length;++d)l[d]=n.charCodeAt(d);p(l.buffer,e)}else{var _=new XMLHttpRequest;_.open(e._xhr.method,r,!0),_.withCredentials=e._xhr.withCredentials,_.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(u){_.setRequestHeader(u,e._xhr.headers[u])}),_.onload=function(){var u=(_.status+"")[0];if(u!=="0"&&u!=="2"&&u!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+_.status+".");return}p(_.response,e)},_.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete f[r],e.load())},A(_)}},A=function(e){try{e.send()}catch{e.onerror()}},p=function(e,r){var n=function(){r._emit("loaderror",null,"Decoding audio data failed.")},l=function(d){d&&r._sounds.length>0?(f[r._src]=d,h(r,d)):n()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(e).then(l).catch(n):t.ctx.decodeAudioData(e,l,n)},h=function(e,r){r&&!e._duration&&(e._duration=r.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},b=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),r=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=r?parseInt(r[1],10):null;if(e&&n&&n<9){var l=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!l&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};s.Howler=t,s.Howl=i,typeof G<"u"?(G.HowlerGlobal=o,G.Howler=t,G.Howl=i,G.Sound=a):typeof window<"u"&&(window.HowlerGlobal=o,window.Howler=t,window.Howl=i,window.Sound=a)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var a=i._howls.length-1;a>=0;a--)i._howls[a].stereo(t);return i},HowlerGlobal.prototype.pos=function(t,i,a){var f=this;if(!f.ctx||!f.ctx.listener)return f;if(i=typeof i!="number"?f._pos[1]:i,a=typeof a!="number"?f._pos[2]:a,typeof t=="number")f._pos=[t,i,a],typeof f.ctx.listener.positionX<"u"?(f.ctx.listener.positionX.setTargetAtTime(f._pos[0],Howler.ctx.currentTime,.1),f.ctx.listener.positionY.setTargetAtTime(f._pos[1],Howler.ctx.currentTime,.1),f.ctx.listener.positionZ.setTargetAtTime(f._pos[2],Howler.ctx.currentTime,.1)):f.ctx.listener.setPosition(f._pos[0],f._pos[1],f._pos[2]);else return f._pos;return f},HowlerGlobal.prototype.orientation=function(t,i,a,f,c,A){var p=this;if(!p.ctx||!p.ctx.listener)return p;var h=p._orientation;if(i=typeof i!="number"?h[1]:i,a=typeof a!="number"?h[2]:a,f=typeof f!="number"?h[3]:f,c=typeof c!="number"?h[4]:c,A=typeof A!="number"?h[5]:A,typeof t=="number")p._orientation=[t,i,a,f,c,A],typeof p.ctx.listener.forwardX<"u"?(p.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),p.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),p.ctx.listener.forwardZ.setTargetAtTime(a,Howler.ctx.currentTime,.1),p.ctx.listener.upX.setTargetAtTime(f,Howler.ctx.currentTime,.1),p.ctx.listener.upY.setTargetAtTime(c,Howler.ctx.currentTime,.1),p.ctx.listener.upZ.setTargetAtTime(A,Howler.ctx.currentTime,.1)):p.ctx.listener.setOrientation(t,i,a,f,c,A);else return h;return p},Howl.prototype.init=function(t){return function(i){var a=this;return a._orientation=i.orientation||[1,0,0],a._stereo=i.stereo||null,a._pos=i.pos||null,a._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},a._onstereo=i.onstereo?[{fn:i.onstereo}]:[],a._onpos=i.onpos?[{fn:i.onpos}]:[],a._onorientation=i.onorientation?[{fn:i.onorientation}]:[],t.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,i){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"stereo",action:function(){a.stereo(t,i)}}),a;var f=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof t=="number")a._stereo=t,a._pos=[t,0,0];else return a._stereo;for(var c=a._getSoundIds(i),A=0;A<c.length;A++){var p=a._soundById(c[A]);if(p)if(typeof t=="number")p._stereo=t,p._pos=[t,0,0],p._node&&(p._pannerAttr.panningModel="equalpower",(!p._panner||!p._panner.pan)&&o(p,f),f==="spatial"?typeof p._panner.positionX<"u"?(p._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),p._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),p._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):p._panner.setPosition(t,0,0):p._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),a._emit("stereo",p._id);else return p._stereo}return a},Howl.prototype.pos=function(t,i,a,f){var c=this;if(!c._webAudio)return c;if(c._state!=="loaded")return c._queue.push({event:"pos",action:function(){c.pos(t,i,a,f)}}),c;if(i=typeof i!="number"?0:i,a=typeof a!="number"?-.5:a,typeof f>"u")if(typeof t=="number")c._pos=[t,i,a];else return c._pos;for(var A=c._getSoundIds(f),p=0;p<A.length;p++){var h=c._soundById(A[p]);if(h)if(typeof t=="number")h._pos=[t,i,a],h._node&&((!h._panner||h._panner.pan)&&o(h,"spatial"),typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(a,Howler.ctx.currentTime)):h._panner.setPosition(t,i,a)),c._emit("pos",h._id);else return h._pos}return c},Howl.prototype.orientation=function(t,i,a,f){var c=this;if(!c._webAudio)return c;if(c._state!=="loaded")return c._queue.push({event:"orientation",action:function(){c.orientation(t,i,a,f)}}),c;if(i=typeof i!="number"?c._orientation[1]:i,a=typeof a!="number"?c._orientation[2]:a,typeof f>"u")if(typeof t=="number")c._orientation=[t,i,a];else return c._orientation;for(var A=c._getSoundIds(f),p=0;p<A.length;p++){var h=c._soundById(A[p]);if(h)if(typeof t=="number")h._orientation=[t,i,a],h._node&&(h._panner||(h._pos||(h._pos=c._pos||[0,0,-.5]),o(h,"spatial")),typeof h._panner.orientationX<"u"?(h._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(a,Howler.ctx.currentTime)):h._panner.setOrientation(t,i,a)),c._emit("orientation",h._id);else return h._orientation}return c},Howl.prototype.pannerAttr=function(){var t=this,i=arguments,a,f,c;if(!t._webAudio)return t;if(i.length===0)return t._pannerAttr;if(i.length===1)if(typeof i[0]=="object")a=i[0],typeof f>"u"&&(a.pannerAttr||(a.pannerAttr={coneInnerAngle:a.coneInnerAngle,coneOuterAngle:a.coneOuterAngle,coneOuterGain:a.coneOuterGain,distanceModel:a.distanceModel,maxDistance:a.maxDistance,refDistance:a.refDistance,rolloffFactor:a.rolloffFactor,panningModel:a.panningModel}),t._pannerAttr={coneInnerAngle:typeof a.pannerAttr.coneInnerAngle<"u"?a.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof a.pannerAttr.coneOuterAngle<"u"?a.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof a.pannerAttr.coneOuterGain<"u"?a.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof a.pannerAttr.distanceModel<"u"?a.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof a.pannerAttr.maxDistance<"u"?a.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof a.pannerAttr.refDistance<"u"?a.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof a.pannerAttr.rolloffFactor<"u"?a.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof a.pannerAttr.panningModel<"u"?a.pannerAttr.panningModel:t._panningModel});else return c=t._soundById(parseInt(i[0],10)),c?c._pannerAttr:t._pannerAttr;else i.length===2&&(a=i[0],f=parseInt(i[1],10));for(var A=t._getSoundIds(f),p=0;p<A.length;p++)if(c=t._soundById(A[p]),c){var h=c._pannerAttr;h={coneInnerAngle:typeof a.coneInnerAngle<"u"?a.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof a.coneOuterAngle<"u"?a.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof a.coneOuterGain<"u"?a.coneOuterGain:h.coneOuterGain,distanceModel:typeof a.distanceModel<"u"?a.distanceModel:h.distanceModel,maxDistance:typeof a.maxDistance<"u"?a.maxDistance:h.maxDistance,refDistance:typeof a.refDistance<"u"?a.refDistance:h.refDistance,rolloffFactor:typeof a.rolloffFactor<"u"?a.rolloffFactor:h.rolloffFactor,panningModel:typeof a.panningModel<"u"?a.panningModel:h.panningModel};var b=c._panner;b?(b.coneInnerAngle=h.coneInnerAngle,b.coneOuterAngle=h.coneOuterAngle,b.coneOuterGain=h.coneOuterGain,b.distanceModel=h.distanceModel,b.maxDistance=h.maxDistance,b.refDistance=h.refDistance,b.rolloffFactor=h.rolloffFactor,b.panningModel=h.panningModel):(c._pos||(c._pos=t._pos||[0,0,-.5]),o(c,"spatial"))}return t},Sound.prototype.init=function(t){return function(){var i=this,a=i._parent;i._orientation=a._orientation,i._stereo=a._stereo,i._pos=a._pos,i._pannerAttr=a._pannerAttr,t.call(this),i._stereo?a.stereo(i._stereo):i._pos&&a.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var i=this,a=i._parent;return i._orientation=a._orientation,i._stereo=a._stereo,i._pos=a._pos,i._pannerAttr=a._pannerAttr,i._stereo?a.stereo(i._stereo):i._pos?a.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,a._refreshBuffer(i)),t.call(this)}}(Sound.prototype.reset);var o=function(t,i){i=i||"spatial",i==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()})(k);const ye=""+new URL("original-theme-66940fbd.mp3",import.meta.url).href,ue=new k.Howl({src:[ye],loop:!0,volume:.15}),Te=""+new URL("fx-cell-c02324c8.mp3",import.meta.url).href,be=new k.Howl({src:[Te],volume:.35}),Ie=""+new URL("fx-fall-b855e7a9.mp3",import.meta.url).href,j=new k.Howl({src:[Ie],volume:1,onplayerror:function(){j.once("unlock",function(){j.play()})}}),xe=""+new URL("fx-hard-drop-701009bf.mp3",import.meta.url).href,Se=new k.Howl({src:[xe],volume:.3}),Fe=""+new URL("fx-rotate-8c04df30.mp3",import.meta.url).href,Me=new k.Howl({src:[Fe],volume:.7}),ke="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjEyLjEwMAAAAAAAAAAAAAAA//twwAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAEAAAGHwBmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmaZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzP////////////////////////////////8AAAAATGF2ZgAAAAAAAAAAAAAAAAAAAAAAJAJAAAAAAAAABh+UlXYKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/7cMQAA9A4/xoNMNVKHyHlwbYm2TpjTSOhp4WjQ8ShAQMcBGIAF63qWJFLErfeB3YL/pJoTC+DOIEa3EoBQAQLfqiXHRspAzEA5RiABw5EcpAHPhIiLgiGAkHIAA+Fcd0ISIiuqEuM4c2W16+E/ODzTN+cMz/2DBQ2vj9YnJ6+83onrn0QleREHk7vY20zAiU9Y95YDCDsoo12ZNTJzJVs2UZQxUOTKYbJFLnUXQX3UqLWMQmJa9So5A9jc34bEqB22fpjqb2FA3zoX2dZ85OrFcryUSkkE4GBkWHWhBDwe4VZWMDUJyOoR42cRTLEKSWyoHn2cJDgoIFDBjTj7M95RBAgpcVzWIBaYrMU4u+lW0YoJCCrYQLzdL+V9LJFMA+VA23GJwbGE4JmPIjAYVAEF4qADBUcyYD/+3LEDQPSjQk0Dr00yhyfZcHcMTlFiJuoTkDW5IRRFKxWNS1YMWABpKoyUBnDUMbd22hlgVTlkeaITsY/1cNFUSIaphinGbCkP2UuzC3ni0pc8CjosrRkzw08Wd0hSDidkyJ/LkhotA/AQnoFAgfaKNrCBM+aEjx5SZ0sNp9GeYRsKkMDslIE7zMo54vrEWa2SQaOhSYjAGgOMNAvYmHAWqrERgDS1pAFExYZSugZcbRVUQryNrwruR7bI6zWtyxczlQ9HWtukzl6GHLmYCuV9o3DQ+IIIno5KCcYIbhJHEfScOyX3ljxkVUpjCbNMMLz1a5hTeTyrYdb5zGkeOPO4991x1HHG/jNIWZy8S1blWXXru4FH9U/dgyoRjBYHFjMDcoTiqRNUcSgYEGSLchvjbA0uMqi6SAVKP/7cMQRg5K9AyIOYePJwxLkCawwIlD1I5rsXV6DBocOI4wThXIMG6FMEfEwGgjVY2HUYJfUoX9XJok9HFNOSdIMyGeLTFQ6qrVMNFXcmJJOR/FuZEAqltTIUqV0qpKMjnE0nkdVWxn2KwHKidTlVbZ1RV0wxzyUjZ0uVbF7nAh6pGjaZJcxIkoFGv1HZSGEgk5BKXdRxgKTrSU2kWQgiFLC6g5IJjzLCMkryamJ20XLjo9ouXLvW9p0JUa3rW+tpy02rWrS7657LrUD2gqIgaATw6JTuSgqEgqAmiI8HQVCrjsKHv5Y9gqDWVBY9iUGuCx7Kg1xYO6xEkxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+3LEIAPAAAGkAAAAIAAANIAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==";new k.Howl({src:[ke],volume:1});class Z{constructor(o,t){v(this,"_matrix");v(this,"_color");v(this,"_darkColor");v(this,"_lightColor");v(this,"_rowIndex");v(this,"_columnIndex");v(this,"_width");v(this,"_height");v(this,"_moveLeft");v(this,"_moveRight");v(this,"_moveDown");v(this,"_rotate");v(this,"_gameField");v(this,"_mergeFunc");v(this,"_eventHandlerKeydown",o=>{(o.keyCode===37||o.keyCode===65)&&(this._moveLeft=!0),(o.keyCode===39||o.keyCode===68)&&(this._moveRight=!0),(o.keyCode===40||o.keyCode===83)&&(this._moveDown=!0),(o.keyCode===38||o.keyCode===87)&&(this._rotate=!0)});v(this,"_eventHandlerKeyup",o=>{(o.keyCode===37||o.keyCode===65)&&(this._moveLeft=!1),(o.keyCode===39||o.keyCode===68)&&(this._moveRight=!1),(o.keyCode===40||o.keyCode===83)&&(this._moveDown=!1),(o.keyCode===38||o.keyCode===87)&&(this._rotate=!1)});this._gameField=o,this._mergeFunc=t,this._matrix=ie[ne(0,ie.length-1)];const i=le[ne(0,le.length-1)];this._color=i[0],this._darkColor=i[1],this._lightColor=i[2],this._height=0,this._width=0,this._rowIndex=oe,this._columnIndex=ae,this._moveLeft=!1,this._moveRight=!1,this._moveDown=!1,this._rotate=!1,this._calcSize(),document.addEventListener("keydown",this._eventHandlerKeydown),document.addEventListener("keyup",this._eventHandlerKeyup)}_calcSize(){const o=this._matrix.map(t=>t.map((i,a)=>i===1?a+1:0)).filter(t=>t.length!==0).flatMap(t=>t);this._width=Math.max(...o),this._height=this._matrix.filter(t=>t.some(i=>i===1)).length}_checkAndNormalize(){for(;this._matrix[0].every(o=>o===0);)this._matrix=this._matrix.slice(1).concat([new Array(this._matrix.length).fill(0)]);for(;this._matrix.every(o=>o[0]===0);)this._matrix=this._matrix.map(o=>o.slice(1).concat([0]))}move(){if(this._moveLeft&&(this._columnIndex>0&&(--this._columnIndex,this._gameField.isCollision(this)&&++this._columnIndex),this._moveLeft=!1),this._moveRight&&(this._columnIndex+this._width<M&&(++this._columnIndex,this._gameField.isCollision(this)&&--this._columnIndex),this._moveRight=!1),this._moveDown&&(this._rowIndex+this._height<D&&(++this._rowIndex,this._gameField.isCollision(this)&&(--this._rowIndex,Se.play(),this._mergeFunc(),this._rowIndex=oe,this._columnIndex=ae)),this._moveDown=!1),this._rotate){if(this._rowIndex>=0){const o=this._matrix;this.rotate(),this._rowIndex+this._height>=D||this._columnIndex+this._width>=M||this._gameField.isCollision(this)?(this._matrix=o,this._calcSize()):Me.play()}this._rotate=!1}}get matrix(){return this._matrix}get color(){return this._color}get darkColor(){return this._darkColor}get lightColor(){return this._lightColor}get rowIndex(){return this._rowIndex}get columnIndex(){return this._columnIndex}get width(){return this._width}get height(){return this._height}get isMovingDown(){return this._moveDown}get isMoving(){return this._moveDown||this._moveLeft||this._moveRight||this._rotate}moveUp(){--this._rowIndex}moveDown(){++this._rowIndex}rotate(){this._matrix=qe(this._matrix),this._checkAndNormalize(),this._calcSize()}}class Ce{constructor(){v(this,"_coloredMatrix");this._coloredMatrix=[],this.reset()}reset(){this._coloredMatrix.length>0&&this._coloredMatrix.splice(0,this._coloredMatrix.length);for(let o=0;o<D;++o)this._coloredMatrix.push(new Array(M).fill({color:"",darkColor:"",lightColor:"",value:0}))}merge(o){o.matrix.forEach((t,i)=>{t.forEach((a,f)=>{const c=o.rowIndex+i;if(a===1&&c>=0){const A=f+o.columnIndex;this._coloredMatrix[c][A]={color:o.color,darkColor:o.darkColor,lightColor:o.lightColor,value:1}}})})}isCollision(o){for(let t=0;t<o.matrix.length;++t)for(let i=0;i<o.matrix[t].length;++i){if(o.rowIndex<0)continue;const a=t+o.rowIndex,f=i+o.columnIndex;if(o.matrix[t][i]===1&&this._coloredMatrix[a][f].value===1)return!0}return!1}hasFullRows(){return!!this._coloredMatrix.some(o=>o.every(t=>t.value===1))}getFullRowIndexes(){return this._coloredMatrix.map((t,i)=>t.every(a=>(a==null?void 0:a.value)===1)?i:0).filter(t=>t>0)}getFullRowsCount(){return this.getFullRowIndexes().length}removeRowCell(o,t){this._coloredMatrix[o][t]={color:"",darkColor:"",lightColor:"",value:0}}shiftEmptyRows(o){this._coloredMatrix.splice(o,1),this._coloredMatrix.unshift(new Array(M).fill({color:"",darkColor:"",lightColor:"",value:0}))}isOver(){return this._coloredMatrix[0].some(o=>o.value===1)}get coloredMatrix(){return this._coloredMatrix}}class Ee{constructor(o){v(this,"canvas");v(this,"_context");v(this,"_gameField");v(this,"_nextFigureField");v(this,"_scoreField");v(this,"_soundButtonField");v(this,"_textInfo");v(this,"_secondaryTextInfo");v(this,"_gameSquare");v(this,"_isMutedSound",!1);v(this,"_mouseClickEventHandler",o=>{const t=this.canvas.getBoundingClientRect(),i=o.clientX-t.left,a=o.clientY-t.top,f=i>this._soundButtonField.positionX&&i<this._soundButtonField.positionX+this._soundButtonField.width&&a>this._soundButtonField.positionY&&a<this._soundButtonField.positionY+this._soundButtonField.height;this._isMutedSound=f?!this._isMutedSound:this._isMutedSound,f&&(this._clearSoundButton(),k.Howler.mute(this._isMutedSound),this.drawSoundControl())});this.canvas=document.querySelector(o),this._context=this.canvas.getContext("2d");const t=Math.round(this.canvas.width/2);this._gameField={positionX:Math.round(this.canvas.width/2)-Math.round(t/2),positionY:Math.round(this.canvas.height/2)-Math.round(t/2)*2,width:t,height:t*2},this._nextFigureField={positionX:this._gameField.positionX+this._gameField.width+Math.round(t/8),positionY:this._gameField.positionY+Math.round(t/8),width:Math.round(t/4),height:Math.round(t/4)*2},this._scoreField={positionX:12,positionY:this._nextFigureField.positionY-28,width:Math.round(this.canvas.width/4)-18,height:this._gameField.height},this._textInfo={positionX:Math.round(this.canvas.width/2),positionY:Math.round(this.canvas.height/2),fontSize:Math.round(this.canvas.width/18),font:"",align:"center"},this._textInfo.font=`bold ${this._textInfo.fontSize}px Cascadia Mono SemiBold`,this._secondaryTextInfo={positionX:Math.round(this.canvas.width/2),positionY:Math.round(this.canvas.height/2)+Math.round(this.canvas.height/7),fontSize:Math.round(this.canvas.width/22),font:"",align:"center"},this._secondaryTextInfo.font=`bold ${this._secondaryTextInfo.fontSize}px Cascadia Mono SemiBold`,this._gameSquare={width:Math.round(t/M)-F,height:Math.round(this._gameField.height/D)-F},this._soundButtonField={positionX:this.canvas.width-68,positionY:this.canvas.height-72,width:56,height:56},this._drawSoundButton(),this.canvas.addEventListener("click",this._mouseClickEventHandler)}drawSoundControl(){if(this._isMutedSound){this._drawMutedSoundButton();return}this._drawSoundButton()}_clearSoundButton(){H(this._context,this._soundButtonField)}_drawSoundButton(){Ae(this._context,this.canvas.width-64,this.canvas.height-64,S,.1)}_drawMutedSoundButton(){pe(this._context,this.canvas.width-60,this.canvas.height-58,S,.1)}clear(){H(this._context,{positionX:0,positionY:0,width:this.canvas.width,height:this.canvas.height})}clearGameField(){H(this._context,this._gameField)}cleartNextFigure(){H(this._context,this._nextFigureField)}clearScoreInfo(){H(this._context,this._scoreField)}drawScoreInfo(o,t,i){const a={...this._secondaryTextInfo};a.positionX=12,a.positionY=this._nextFigureField.positionY-20,a.font="bold 16px Cascadia Mono SemiBold",a.align="left",C(this._context,a,S,"SCORE:"),a.font="bold 20px Cascadia Mono SemiBold",a.positionY+=40,C(this._context,a,S,`${i}`.padStart(9,"0")),a.positionY+=80,a.font="bold 16px Cascadia Mono SemiBold",C(this._context,a,S,`LEVEL: ${o}`),a.positionY+=80,C(this._context,a,S,`LINES: ${t}`)}drawNextFigureField(){const o={...this._secondaryTextInfo};o.positionX=this._nextFigureField.positionX,o.positionY=this._nextFigureField.positionY-20,o.font="bold 16px Cascadia Mono SemiBold",o.align="left",C(this._context,o,S,"N E X T:");for(let t=1;t<3;++t)re(this._context,S,this._nextFigureField.positionX-t,this._nextFigureField.positionY-t,this._nextFigureField.width+t*2,this._nextFigureField.height+t*2)}drawGameField(){for(let o=1;o<4;++o)re(this._context,S,this._gameField.positionX-F-o,this._gameField.positionY-F-o,this._gameField.width+F+o*2,this._gameField.height+F+o*2)}drawNextFigure(o){const t=Math.round(this._nextFigureField.width/5)-1;o.matrix.forEach((i,a)=>{i.forEach((f,c)=>{if(f===1){const A=this._nextFigureField.positionX+(c+1)*(t+1),p=this._nextFigureField.positionY+(a+3)*(t+1);K(this._context,o.color,A,p,t,t)}})})}drawGameFigure(o){o.matrix.forEach((t,i)=>{t.forEach((a,f)=>{a===1&&this.drawGameSquare(o.columnIndex+f,o.rowIndex+i,o.color,o.darkColor,o.lightColor)})})}drawGameSquare(o,t,i,a,f){if(t<0)return;const c=this._gameField.positionX+(this._gameSquare.width+F)*o,A=this._gameField.positionY+(this._gameSquare.height+F)*t;K(this._context,i,c,A,this._gameSquare.width,this._gameSquare.height),me(this._context,a,f,c,A,this._gameSquare.width,this._gameSquare.height)}drawFieldMatrix(o){o.coloredMatrix.forEach((t,i)=>{t.forEach((a,f)=>{(a==null?void 0:a.value)===1&&this.drawGameSquare(f,i,a==null?void 0:a.color,a==null?void 0:a.darkColor,a==null?void 0:a.lightColor)})})}drawInfo(o,t){K(this._context,"#0a0a0a",this._textInfo.positionX-Math.round(this.canvas.width/3),this._textInfo.positionY-Math.round(this.canvas.height/8),Math.round(this.canvas.width/1.5),Math.round(this.canvas.height/3)),C(this._context,this._textInfo,t,o)}drawSecondaryInfo(o,t){C(this._context,this._secondaryTextInfo,t,o)}}const w=new Ee(ve),T=new Ce;let R=new Z(T,L),I=new Z(T,L),P=0,N=1,W=0,U=0,V=!1,Q=0,E=[],se=0,$=!1;function de(){if(w.clearGameField(),V&&++se>10?(E.some(s=>s.columnsCount>0)?(E.forEach((s,o)=>{if(o===0||E[o-1].columnsCount<M-2){const t=M-Math.floor(s.columnsCount/2),i=Math.floor(s.columnsCount/2)-1;s.columnsCount>0&&(T.removeRowCell(s.rowIndex,t),T.removeRowCell(s.rowIndex,i),be.play(),s.columnsCount-=2)}}),E.filter(s=>s.columnsCount===0).forEach(s=>{T.shiftEmptyRows(s.rowIndex),s.columnsCount=-1})):(V=!1,E=[],Le(Q),Q=0),se=0):(I.isMoving&&I.rowIndex>=0&&(I.move(),P>0&&(P-=10)),++P>ge&&(I.rowIndex+I.height<D&&(I.moveDown(),T.isCollision(I)&&(I.moveUp(),j.play(),L())),I.rowIndex+I.height>=D&&(j.play(),L()),P=0)),w.drawFieldMatrix(T),w.drawGameFigure(I),T.isOver()&&!V){Oe();return}requestAnimationFrame(()=>{de()})}function L(){T.merge(I),I=R,R=new Z(T,L),w.cleartNextFigure(),w.drawNextFigure(R),Q=T.getFullRowsCount(),Q>0&&(V=!0,E=T.getFullRowIndexes().map(s=>({rowIndex:s,columnsCount:M})))}function Le(s){W+=N*s*10,U+=s,w.clearScoreInfo(),w.drawScoreInfo(N,U,W)}function Oe(){$=!1,ue.stop(),w.drawInfo("GAME OVER",we),w.drawSecondaryInfo("press space to start",Y)}document.addEventListener("keypress",function(s){if(s.keyCode===32){if($)return;$=!0,Be()}});function Be(){R=new Z(T,L),I=new Z(T,L),P=0,N=1,W=0,U=0,V=!1,Q=0,E=[],w.clear(),w.drawGameField(),w.drawNextFigureField(),w.drawNextFigure(R),w.drawScoreInfo(N,U,W),w.drawSoundControl(),T.reset(),ue.play(),de()}w.drawGameField();w.drawNextFigureField();w.drawNextFigure(R);w.drawScoreInfo(N,U,W);w.drawInfo("GET READY!",Y);w.drawSecondaryInfo("press space to start",Y);
